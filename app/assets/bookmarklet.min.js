(function(){if(!document.getElementById("arena")){var e,t;n(),r(),i(),s(),o(),document.onkeyup=function(e){if(e||window.event)e=window.event,e.keyCode==27&&p()},window.addEventListener("message",d);function n(){e=document.createElement("iframe"),e.name=e.id="arena_frame",e.src="http://localhost:3333",document.body.appendChild(e)}function r(){t=document.createElement("div"),t.id="arena_div",document.body.appendChild(t)}function i(){marklet_style=document.createElement("style"),marklet_style.type="text/css",marklet_css="#arena_frame,#arena_div{width:100%;height:137px;position:fixed;bottom:0;left:0;right:0;border:none}#arena_frame{border-top:1px solid rgba(0,0,0,0.1);z-index:9999999998;background:rgba(255,255,255,0.75)}#arena_frame:hover{background:rgba(255,255,255,0.9)}#arena_div{z-index:9999999999;display:none;opacity:0}",marklet_style.styleSheet?marklet_style.styleSheet.cssText=marklet_css:marklet_style.appendChild(document.createTextNode(marklet_css)),document.body.appendChild(marklet_style)}function s(){document.addEventListener("dragstart",u,!0),document.addEventListener("dragend",a,!0)}function o(){t.addEventListener("dragover",f,!0),t.addEventListener("dragenter",l,!1),t.addEventListener("dragleave",c,!1),t.addEventListener("drop",h,!1)}function u(e){var n;typeof e.dataTransfer.getData("text/html")=="undefined"&&e.target.tagName=="IMG"&&(n=m(e.target,"A")),n?(parentHTML=n.cloneNode(!1),parentHTML.href=parentHTML.href,targetImage=e.target.cloneNode(!1),targetImage.src=targetImage.src,parentHTML.appendChild(targetImage),e.dataTransfer.setData("text/html",parentHTML.outerHTML)):(targetImage=e.target.cloneNode(!1),targetImage.src=targetImage.src,e.dataTransfer.setData("text/html",targetImage.outerHTML)),t.style.display="block"}function a(e){t.style.display="none"}function f(e){return e.stopPropagation(),e.preventDefault(),!1}function l(e){return v({action:"dragenter"}),!1}function c(e){return v({action:"dragleave"}),!1}function h(e){var t={source:location.href,title:document.title};for(var n in e.dataTransfer.types)t[e.dataTransfer.types[n]]=e.dataTransfer.getData(e.dataTransfer.types[n]);return v({action:"drop",value:t}),e.stopPropagation(),e.preventDefault(),!1}function p(){window.removeEventListener&&window.removeEventListener("message",d,!1),e&&document.body.removeChild(e),t&&document.body.removeNode(t),marklet_style&&document.body.removeNode(marklet_style)}function d(e){e.data.action=="issidebar"?v({action:"issidebar",value:!0}):e.data.action=="close"&&p()}function v(t){e.contentWindow.postMessage(t,"*")}function m(e,t){while(e.parentNode){e=e.parentNode;if(e.tagName==t)return e}}}})();